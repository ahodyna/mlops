# üê∂ –í–∏—è–≤–ª–µ–Ω–Ω—è —Å–æ–±–∞–∫–∏ –Ω–∞ –∑–æ–±—Ä–∞–∂–µ–Ω–Ω—è—Ö (Object Detection)

–¶–µ–π —Ä–µ–ø–æ–∑–∏—Ç–æ—Ä—ñ–π –º—ñ—Å—Ç–∏—Ç—å —ñ–Ω—Å—Ç—Ä—É–º–µ–Ω—Ç–∏ –¥–ª—è —Ä–æ–∑–º—ñ—Ç–∫–∏ –∑–æ–±—Ä–∞–∂–µ–Ω—å —ñ–∑ —Å–æ–±–∞–∫–∞–º–∏, –∑–±–µ—Ä—ñ–≥–∞–Ω–Ω—è –¥–∞–Ω–∏—Ö —ñ –ø—ñ–¥–≥–æ—Ç–æ–≤–∫–∏ —ó—Ö –¥–æ –Ω–∞–≤—á–∞–Ω–Ω—è –º–æ–¥–µ–ª—ñ –≤–∏—è–≤–ª–µ–Ω–Ω—è –æ–±'—î–∫—Ç—ñ–≤.

---

## üìå –ö–æ–º–ø–æ–Ω–µ–Ω—Ç–∏ —Å–∏—Å—Ç–µ–º–∏

- **üè∑Ô∏è –†–æ–∑–º—ñ—Ç–∫–∞ –¥–∞–Ω–∏—Ö**: [Label Studio](https://labelstud.io/) - –≤–µ–±-—ñ–Ω—Ç–µ—Ä—Ñ–µ–π—Å –¥–ª—è –∞–Ω–æ—Ç–∞—Ü—ñ—ó –∑–æ–±—Ä–∞–∂–µ–Ω—å
- **üß† –ú–æ–¥–µ–ª—å**: YOLOv8 - —Å—É—á–∞—Å–Ω–∞ –∞—Ä—Ö—ñ—Ç–µ–∫—Ç—É—Ä–∞ –¥–ª—è –¥–µ—Ç–µ–∫—Ü—ñ—ó –æ–±'—î–∫—Ç—ñ–≤
- **üìä –¢—Ä–µ–∫—ñ–Ω–≥ –µ–∫—Å–ø–µ—Ä–∏–º–µ–Ω—Ç—ñ–≤**: MLflow - –≤–µ—Ä—Å—ñ–æ–Ω—É–≤–∞–Ω–Ω—è —Ç–∞ –º–æ–Ω—ñ—Ç–æ—Ä–∏–Ω–≥ –º–æ–¥–µ–ª–µ–π
- **üíæ –°—Ö–æ–≤–∏—â–µ**: MinIO - S3-—Å—É–º—ñ—Å–Ω–µ —Å—Ö–æ–≤–∏—â–µ –¥–ª—è –¥–∞–Ω–∏—Ö —Ç–∞ –∞—Ä—Ç–µ—Ñ–∞–∫—Ç—ñ–≤
- **üîß –í–µ—Ä—Å—ñ–æ–Ω—É–≤–∞–Ω–Ω—è –¥–∞–Ω–∏—Ö**: DVC - –∫–æ–Ω—Ç—Ä–æ–ª—å –≤–µ—Ä—Å—ñ–π –¥–∞—Ç–∞—Å–µ—Ç—ñ–≤
- **üöÄ API**: FastAPI - REST API –¥–ª—è —ñ–Ω—Ñ–µ—Ä–µ–Ω—Å—É –º–æ–¥–µ–ª—ñ
- **üìà –ú–æ–Ω—ñ—Ç–æ—Ä–∏–Ω–≥**: Prometheus + Grafana - –º–µ—Ç—Ä–∏–∫–∏ —Ç–∞ –≤—ñ–∑—É–∞–ª—ñ–∑–∞—Ü—ñ—è
- **üê≥ –û—Ä–∫–µ—Å—Ç—Ä–∞—Ü—ñ—è**: Docker Compose - –∫–æ–Ω—Ç–µ–π–Ω–µ—Ä–∏–∑–∞—Ü—ñ—è –≤—Å—ñ—Ö —Å–µ—Ä–≤—ñ—Å—ñ–≤

## 1. –ó–∞–ø—É—Å—Ç—ñ—Ç—å docker-compose —Ñ–∞–π–ª:

     docker-compose up


## 2. –°—Ç–≤–æ—Ä—ñ—Ç—å –æ–±–ª—ñ–∫–æ–≤—ñ –∑–∞–ø–∏—Å–∏

- **Label Studio**: [http://localhost:8080](http://localhost:8080)  
- **MLflow**: [http://localhost:5001](http://localhost:5001)
- **Prometheus**: [http://localhost:9090](http://localhost:9090)  
- **Grafana**: [http://localhost:3000](http://localhost:3000)
- **Dog Detection API**: [http://localhost:8001](http://localhost:8001)
- **MinIO**: [http://localhost:9009](http://localhost:9009)  
  > üîê –î–∞–Ω—ñ –¥–ª—è –≤—Ö–æ–¥—É –≤–∫–∞–∑–∞–Ω—ñ —É `docker-compose.yml`.

---

## 3. –ù–∞–ª–∞—à—Ç—É–π—Ç–µ MinIO

1. –°—Ç–≤–æ—Ä—ñ—Ç—å –±–∞–∫–µ—Ç.
2. –ó–∞–≤–∞–Ω—Ç–∞–∂—Ç–µ –∑–æ–±—Ä–∞–∂–µ–Ω–Ω—è –¥–ª—è —Ä–æ–∑–º—ñ—Ç–∫–∏.

---

## 4. –ù–∞–ª–∞—à—Ç—É–π—Ç–µ Label Studio

1. –°—Ç–≤–æ—Ä—ñ—Ç—å –Ω–æ–≤–∏–π –ø—Ä–æ—î–∫—Ç.
2. –ü–µ—Ä–µ–π–¥—ñ—Ç—å —É `Settings ‚Üí Cloud Storage`.
3. –î–æ–¥–∞–π—Ç–µ –ø—ñ–¥–∫–ª—é—á–µ–Ω–Ω—è –¥–æ –≤–∞—à–æ–≥–æ –±–∞–∫–µ—Ç–∞ MinIO.
4. –ù–∞—Ç–∏—Å–Ω—ñ—Ç—å **Sync Storage**, —â–æ–± —ñ–º–ø–æ—Ä—Ç—É–≤–∞—Ç–∏ –∑–æ–±—Ä–∞–∂–µ–Ω–Ω—è.

---

## 5. –†–æ–∑–º—ñ—Ç–∫–∞ –¥–∞–Ω–∏—Ö

1. –í—ñ–¥–º—ñ—á–∞–π—Ç–µ –∑–æ–Ω–∏ —ñ–∑ —Å–æ–±–∞–∫–∞–º–∏ –Ω–∞ –∑–æ–±—Ä–∞–∂–µ–Ω–Ω—è—Ö.
2. –ü—ñ—Å–ª—è –∑–∞–≤–µ—Ä—à–µ–Ω–Ω—è —Ä–æ–∑–º—ñ—Ç–∫–∏ –µ–∫—Å–ø–æ—Ä—Ç—É–π—Ç–µ —Ä–µ–∑—É–ª—å—Ç–∞—Ç–∏ (–Ω–∞–ø—Ä–∏–∫–ª–∞–¥, —É —Ñ–æ—Ä–º–∞—Ç—ñ **YOLO**).

---

## üìÇ –í–µ—Ä—Å—ñ–æ–Ω—É–≤–∞–Ω–Ω—è –¥–∞–Ω–∏—Ö —ñ–∑ DVC

### 1. –ü—ñ–¥–≥–æ—Ç—É–π—Ç–µ —Å—Ç—Ä—É–∫—Ç—É—Ä—É

- –°—Ç–≤–æ—Ä—ñ—Ç—å –ø–∞–ø–∫—É `dataset`.
- –î–æ–¥–∞–π—Ç–µ —Ä–æ–∑–º—ñ—á–µ–Ω—ñ –¥–∞–Ω—ñ, —è–∫—ñ –µ–∫—Å–ø–æ—Ä—Ç—É–≤–∞–ª–∏ –∑ Label Studio.

### 2. –ù–∞–ª–∞—à—Ç—É–π—Ç–µ DVC

1. –ê–∫—Ç–∏–≤—É–π—Ç–µ Python-–≤—ñ—Ä—Ç—É–∞–ª—å–Ω–µ —Å–µ—Ä–µ–¥–æ–≤–∏—â–µ.
2. –í—Å—Ç–∞–Ω–æ–≤—ñ—Ç—å DVC:

   ```bash
   pip install dvc
   dvc add dataset
   
   git add .
   commit -m "New version of labeled data"
   dvc push

    ```

   ## ü§ñ –¢—Ä–µ–Ω—É–≤–∞–Ω–Ω—è –º–æ–¥–µ–ª—ñ

### 3. –ü–∞—Ä–∞–º–µ—Ç—Ä–∏ —Ç—Ä–µ–Ω—É–≤–∞–Ω–Ω—è

| –ü–∞—Ä–∞–º–µ—Ç—Ä | –û–ø–∏—Å | –ó–Ω–∞—á–µ–Ω–Ω—è –∑–∞ –∑–∞–º–æ–≤—á—É–≤–∞–Ω–Ω—è–º |
|----------|------|---------------------------|
| `--model` | –†–æ–∑–º—ñ—Ä YOLOv8 –º–æ–¥–µ–ª—ñ | `yolov8s.pt` |
| `--epochs` | –ö—ñ–ª—å–∫—ñ—Å—Ç—å –µ–ø–æ—Ö | `50` |
| `--batch` | –†–æ–∑–º—ñ—Ä batch | `2` |
| `--lr0` | Learning rate | `0.0001` |
| `--imgsz` | –†–æ–∑–º—ñ—Ä –∑–æ–±—Ä–∞–∂–µ–Ω—å | `416` |

### –ü—ñ–¥–≥–æ—Ç–æ–≤–∫–∞ –¥–∞–Ω–∏—Ö

```bash
# –ü–µ—Ä–µ–º–∞–ø–ª–µ–Ω–Ω—è –¥–∞—Ç–∞—Å–µ—Ç—É 
python create_number_mapping.py
```

### –ó–∞–ø—É—Å–∫ —Ç—Ä–µ–Ω—É–≤–∞–Ω–Ω—è

```bash
python src/train_yolo.py --epochs 5 --batch 4
```

### –ú–æ–Ω—ñ—Ç–æ—Ä–∏–Ω–≥
## üìä –ú–æ–Ω—ñ—Ç–æ—Ä–∏–Ω–≥ —Ç–∞ —Ä–µ–∑—É–ª—å—Ç–∞—Ç–∏

### MLflow UI

–í—ñ–¥–∫—Ä–∏–π—Ç–µ [http://localhost:5001](http://localhost:5001) –¥–ª—è –ø–µ—Ä–µ–≥–ª—è–¥—É:

- **–ú–µ—Ç—Ä–∏–∫–∏**: mAP50, mAP50-95, Precision, Recall
- **–ü–∞—Ä–∞–º–µ—Ç—Ä–∏**: –≤—Å—ñ –≥—ñ–ø–µ—Ä–ø–∞—Ä–∞–º–µ—Ç—Ä–∏ —Ç—Ä–µ–Ω—É–≤–∞–Ω–Ω—è
- **–ê—Ä—Ç–µ—Ñ–∞–∫—Ç–∏**: –≥—Ä–∞—Ñ—ñ–∫–∏ –Ω–∞–≤—á–∞–Ω–Ω—è, —Ä–µ–∑—É–ª—å—Ç–∞—Ç–∏ –≤–∞–ª—ñ–¥–∞—Ü—ñ—ó
- **–ú–æ–¥–µ–ª—ñ**: –∑–±–µ—Ä–µ–∂–µ–Ω—ñ checkpoint'–∏



---

## üîÆ –Ü–Ω—Ñ–µ—Ä–µ–Ω—Å —Ç–∞ –≤–∏–∫–æ—Ä–∏—Å—Ç–∞–Ω–Ω—è

### 1. –¢–µ—Å—Ç—É–≤–∞–Ω–Ω—è —á–µ—Ä–µ–∑ —Å–∫—Ä–∏–ø—Ç

```bash
# –Ü–Ω—Ñ–µ—Ä–µ–Ω—Å –Ω–∞ –≤—Å—ñ—Ö –∑–æ–±—Ä–∞–∂–µ–Ω–Ω—è—Ö –∑ –ø–∞–ø–∫–∏
python src/yolo_inference.py --test_dir test_images

# –¢–µ—Å—Ç—É–≤–∞–Ω–Ω—è –æ–¥–Ω–æ–≥–æ –∑–æ–±—Ä–∞–∂–µ–Ω–Ω—è
python src/yolo_inference.py --single_image path/to/image.jpg

# –í–∏–∫–æ—Ä–∏—Å—Ç–∞–Ω–Ω—è –∫–æ–Ω–∫—Ä–µ—Ç–Ω–æ—ó –º–æ–¥–µ–ª—ñ
python src/yolo_inference.py \
    --model models/dog_detection_20241215_12345/best.pt \
    --confidence 0.7 \
    --iou 0.5

# –°–ø–∏—Å–æ–∫ –¥–æ—Å—Ç—É–ø–Ω–∏—Ö –º–æ–¥–µ–ª–µ–π
python src/yolo_inference.py --list_models
```

### 2. REST API

#### –ó–∞–ø—É—Å–∫ API

```bash
# API –∞–≤—Ç–æ–º–∞—Ç–∏—á–Ω–æ –∑–∞–ø—É—Å–∫–∞—î—Ç—å—Å—è –∑ docker-compose
# –ê–±–æ –æ–∫—Ä–µ–º–æ:
cd dog-detection-api
python main.py
```

#### –ü—Ä–∏–∫–ª–∞–¥–∏ –≤–∏–∫–æ—Ä–∏—Å—Ç–∞–Ω–Ω—è

```bash
# –ü–µ—Ä–µ–≤—ñ—Ä–∫–∞ —Å—Ç–∞—Ç—É—Å—É
curl http://localhost:8001/health

# –°–ø–∏—Å–æ–∫ –¥–æ—Å—Ç—É–ø–Ω–∏—Ö –º–æ–¥–µ–ª–µ–π
curl http://localhost:8001/models

# –î–µ—Ç–µ–∫—Ü—ñ—è –Ω–∞ –æ–¥–Ω–æ–º—É –∑–æ–±—Ä–∞–∂–µ–Ω–Ω—ñ
curl -X POST "http://localhost:8001/predict" \
  -H "Content-Type: multipart/form-data" \
  -F "file=@test_image.jpg" \
  -F "confidence=0.6"

# Batch –¥–µ—Ç–µ–∫—Ü—ñ—è
curl -X POST "http://localhost:8001/batch-predict" \
  -H "Content-Type: multipart/form-data" \
  -F "files=@image1.jpg" \
  -F "files=@image2.jpg"
```

#### API Endpoints

| Endpoint | –ú–µ—Ç–æ–¥ | –û–ø–∏—Å |
|----------|-------|------|
| `/` | GET | –Ü–Ω—Ñ–æ—Ä–º–∞—Ü—ñ—è –ø—Ä–æ API |
| `/health` | GET | –°—Ç–∞—Ç—É—Å —Å–µ—Ä–≤—ñ—Å—É |
| `/models` | GET | –°–ø–∏—Å–æ–∫ –º–æ–¥–µ–ª–µ–π |
| `/predict` | POST | –î–µ—Ç–µ–∫—Ü—ñ—è –Ω–∞ –æ–¥–Ω–æ–º—É –∑–æ–±—Ä–∞–∂–µ–Ω–Ω—ñ |
| `/batch-predict` | POST | Batch –¥–µ—Ç–µ–∫—Ü—ñ—è (–¥–æ 10 —Ñ–∞–π–ª—ñ–≤) |
| `/stats` | GET | –°—Ç–∞—Ç–∏—Å—Ç–∏–∫–∞ —Å–µ—Ä–≤—ñ—Å—É |

### 3. –†–µ–∑—É–ª—å—Ç–∞—Ç–∏ —ñ–Ω—Ñ–µ—Ä–µ–Ω—Å—É

```json
{
  "filename": "dog_photo.jpg",
  "detections": [
    {
      "bbox": [245.3, 167.8, 456.2, 378.9],
      "confidence": 0.87,
      "class_id": 0,
      "class_name": "dog"
    }
  ],
  "detection_count": 1,
  "timestamp": "2024-12-15T14:30:25"
}
```

---

### Prometheus + Grafana
- **–ú–µ—Ç—Ä–∏–∫–∏ API**: `dog_predictions_total`, `dog_processing_seconds`, `dogs_detected_total`
- **–î–∞—à–±–æ—Ä–¥**: "Dog Detection API Dashboard" —É Grafana

### YOLO ML Pipeline

–û—Å–Ω–æ–≤–Ω–∏–π –ø–∞–π–ø–ª–∞–π–Ω –≤–∫–ª—é—á–∞—î —Ç—Ä–∏ –µ—Ç–∞–ø–∏:

1. **setup-infrastructure** - –∑–∞–ø—É—Å–∫ MinIO, MLflow, DB –∑ –ø–µ—Ä–µ–≤—ñ—Ä–∫–æ—é –≥–æ—Ç–æ–≤–Ω–æ—Å—Ç—ñ —Å–µ—Ä–≤—ñ—Å—ñ–≤
2. **train** - –≤—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω–Ω—è –∑–∞–ª–µ–∂–Ω–æ—Å—Ç–µ–π, —Ç—Ä–µ–Ω—É–≤–∞–Ω–Ω—è YOLOv8 –º–æ–¥–µ–ª—ñ (10 –µ–ø–æ—Ö), –∑–±–µ—Ä–µ–∂–µ–Ω–Ω—è –≤ MinIO
3. **deploy** - –¥–µ–ø–ª–æ–π API –¥–ª—è —ñ–Ω—Ñ–µ—Ä–µ–Ω—Å—É –∑ –≥–æ—Ç–æ–≤–Ω—ñ—Å—Ç—é –¥–ª—è —Ç–µ—Å—Ç—É–≤–∞–Ω–Ω—è

```bash
# –ó–∞–ø—É—Å–∫ –ø–æ–≤–Ω–æ–≥–æ ML –ø–∞–π–ø–ª–∞–π–Ω—É
act 

```

## üîÆ –ü–æ–¥–∞–ª—å—à–µ –≤–∏–∫–æ—Ä–∏—Å—Ç–∞–Ω–Ω—è
- –î–∞–Ω—ñ –±—É–¥—É—Ç—å –≤–∏–∫–æ—Ä–∏—Å—Ç–∞–Ω—ñ –¥–ª—è –Ω–∞–≤—á–∞–Ω–Ω—è —Ç–∞ —Ç–µ—Å—Ç—É–≤–∞–Ω–Ω—è –º–æ–¥–µ–ª—ñ, —è–∫–∞ –¥–æ–∑–≤–æ–ª–∏—Ç—å –∞–≤—Ç–æ–º–∞—Ç–∏—á–Ω–æ –≤–∏—è–≤–ª—è—Ç–∏ —Å–æ–±–∞–∫—É –Ω–∞ –Ω–æ–≤–∏—Ö —Ñ–æ—Ç–æ.

